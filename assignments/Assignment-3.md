# CS6650 Assignment 3

## Building the Data Layer

This assignment builds on assignment 2. The main aim is to persist the tuples generated by the your client.

## Step 1 - Add a  Database

In assignment 2, your consumer created an in-memory hash map to skier, lift ride and resort information. 

Your first task is to modify the consumer to persist the results to a database. 

In thsi assignment you are free to choose your own database. Popular past choices are:

- Redis (https://redis.io/) 
- MySQL using AWS RDS, Postgres or Aurora
- DynamoDB
- MongoDB 

You can find a summary of AWS databases and costs [here](https://aws.amazon.com/free/database/). Choose wisely!

The data model you design in the database should enable queries like:

* "For skier N, how many days have they skied this season?"
* "For skier N, what are the vertical totals for each ski day?" (calculate vertical as liftID*10)
* "For skier N, show me the lifts they rode on each ski day"
* "How many unique skiers visited resort X on day N?"

The challenge is to write to the database ideally as fast as you can consume messages from RabbitMQ. This may be challenging based on the EC2 resources you choose, so experiments required. 

## Step 2 - Putting it all Together

This is the fun bit. Run tests that populate the database as fast as possible. To simplify, feel free to increase the capacity of your servlets/RMQ server if you have the budget and don't use the load balancer. - just report the configuration you used for gathering results and watch your $$s!

It's likely you will see significant backlogs in your queues, servlet and maybe even consumers. 

If you do, you have two choices:

1. Increase capacity - this means deploying more than free tier instances. Watch the $$s. 
2. Introduce throttling - you could do this e.g. in the client by introducing a throughput-based circuit breaker with exponential backoffs in client POSTs and/or RMQ posts/configuration

Your aim is to try and deliver stable throughput at the client, with short queues as in assignment 2, and eliminate client errors that may occur when no mitigation measures were used.

## Submission Requirements

Submit your work to Canvas Assignment 3 as a pdf document. The document should contain:

1. The URL for your git repo. Create a new folder for your Assignment 3 server code
1. A short description of your database designs and deployment topologies on AWS. Include instance types if you have increase capacity.
1. Client test run and RMQ console screen shots showing your best throughput with ideally short, stable queue lengths. 

## Grading:

1. Server and database implementations working (10 points)
1. Database design description (5 points) 
1. Step 3 - (15) Client screenshots and RMQ console clips showing your best performance.

#### Redis Info

You can install Redis on AWS Linux.

Install instructions on AWS Linux are [here](https://shawn-shi.medium.com/how-to-install-redis-on-ec2-server-for-fast-in-memory-database-f30c3ef8c35e),  or if Medium access is painful [here](https://www.phaedrasolutions.com/blog/setup-redis-on-aws).




